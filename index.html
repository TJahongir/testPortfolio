<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Your Name - Portfolio</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Your Name</h1>
    <nav>
      <a href="#about">About</a>
      <a href="#projects">Projects</a>
      <a href="#contact">Contact</a>
    </nav>
  </header>

  <section id="about">
    <h2>About Me</h2>
    <p>
      Hi! I’m [Your Name], and this is my personal portfolio site. I build cool
      stuff and share my projects here.
    </p>
  </section>

  <section id="projects">
    <h2>Projects</h2>
    <div class="projects-grid" id="project-list"></div>
  </section>

  <section id="contact">
    <h2>Contact Me</h2>
    <form action="https://formspree.io/f/{your-form-id}" method="POST">
      <input type="text" name="name" placeholder="Your Name" required />
      <input type="email" name="_replyto" placeholder="Your Email" required />
      <textarea name="message" placeholder="Your Message"></textarea>
      <button type="submit">Send</button>
    </form>
  </section>

  <footer>
    <p>© 2025 Your Name</p>
  </footer>

  <script src="https://unpkg.com/showdown/dist/showdown.min.js"></script>
<script>
  // CONFIG - set these
  const GITHUB_USER = "TJahongir"; // e.g. "jakh"
  const GITHUB_REPO = "testPortfolio";       // e.g. "portfolio"
  const BRANCH = "main";                      // your branch name

  // parse YAML frontmatter (very small parser)
  function parseFrontMatter(md) {
    const fmRegex = /^---\s*([\s\S]*?)\s*---/;
    const match = md.match(fmRegex);
    if (!match) return { attributes: {}, body: md };
    const fm = match[1];
    const body = md.slice(match[0].length).trim();
    const attributes = {};
    fm.split(/\n/).forEach(line => {
      if (!line.trim()) return;
      const [key, ...rest] = line.split(':');
      if (!key) return;
      let value = rest.join(':').trim();
      // remove starting/trailing quotes if present
      value = value.replace(/^"(.*)"$/, '$1').replace(/^'(.*)'$/, '$1');
      attributes[key.trim()] = value;
    });
    return { attributes, body };
  }

  async function loadProjects() {
    const list = document.getElementById("project-list");
    if (!list) return;
    list.innerHTML = "<p>Loading projects…</p>";
    const converter = new showdown.Converter();

    try {
      const apiUrl = `https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/projects?ref=${BRANCH}`;
      const res = await fetch(apiUrl);
      if (!res.ok) {
        list.innerHTML = "<p>No projects found (check repo public / paths).</p>";
        console.error("GitHub API error:", res.status, await res.text());
        return;
      }
      const files = await res.json();
      const mdFiles = files.filter(f => f.name && f.name.endsWith('.md'));
      if (mdFiles.length === 0) {
        list.innerHTML = "<p>No project markdown files found in /projects.</p>";
        return;
      }

      list.innerHTML = ""; // clear loading text
      for (const file of mdFiles) {
        const rawUrl = `https://raw.githubusercontent.com/${GITHUB_USER}/${GITHUB_REPO}/${BRANCH}/projects/${file.name}`;
        const r = await fetch(rawUrl);
        if (!r.ok) continue;
        const md = await r.text();
        const { attributes, body } = parseFrontMatter(md);
        const htmlBody = converter.makeHtml(body || "");
        const title = attributes.title || "";
        const desc = attributes.description || "";
        const image = attributes.image ? attributes.image : "";
        const link = attributes.link ? attributes.link : "";

        const card = document.createElement("article");
        card.className = "project-card";

        card.innerHTML = `
          ${image ? `<img src="${image}" alt="${title}" />` : ""}
          <div class="project-card-content">
            ${title ? `<h3>${title}</h3>` : ""}
            ${desc ? `<p class="meta">${desc}</p>` : ""}
            <div class="project-body">${htmlBody}</div>
            ${link ? `<p><a class="project-link" href="${link}" target="_blank" rel="noopener">View Project →</a></p>` : ""}
          </div>
        `;

        list.appendChild(card);
      }
    } catch (err) {
      console.error("Error loading projects:", err);
      list.innerHTML = "<p>Failed to load projects (see console).</p>";
    }
  }

  loadProjects();
</script>

</body>
</html>
